{% extends "base.html" %}

{% block title %}Home{% endblock %}

{% block content %}
<div class="dashboard-header" data-aos="fade-down">
  <h1 class="welcome-text">Welcome back, {{ user }}!</h1>
  <p class="text-muted">Access your services and monitoring tools</p>
</div>

<div class="dashboard-grid">
  <!-- Media Management Section -->
  <section class="dashboard-section" data-aos="fade-up">
    <h2 class="section-title">
      <i class="fas fa-photo-film"></i>
      Media Management
    </h2>
    <div class="service-grid">
      <!-- Default services -->
      <a href="https://drewwilliams.biz/sonarr/" target="_blank" class="service-card">
        <div class="service-icon">
          <i class="fas fa-tv"></i>
        </div>
        <h3>Sonarr</h3>
        <p>TV Show Management</p>
      </a>

      <a href="https://drewwilliams.biz/radarr/" target="_blank" class="service-card">
        <div class="service-icon">
          <i class="fas fa-film"></i>
        </div>
        <h3>Radarr</h3>
        <p>Movie Management</p>
      </a>

      <a href="https://drewwilliams.biz/nzbget/" target="_blank" class="service-card">
        <div class="service-icon">
          <i class="fas fa-download"></i>
        </div>
        <h3>NZBGet</h3>
        <p>Download Manager</p>
      </a>
      
      <!-- Custom services for media section -->
      {% for service in media_services %}
      <a href="{{ service.url }}" target="_blank" class="service-card">
        <div class="service-icon">
          <i class="fas {{ service.icon }}"></i>
        </div>
        <h3>{{ service.name }}</h3>
        <p>{{ service.description }}</p>
        <form method="POST" action="{{ url_for('delete_service', service_id=service.id) }}"
              class="delete-service" onsubmit="return confirm('Delete this service?');">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
          <button type="submit" class="btn-delete-service" title="Delete service">
            <i class="fas fa-trash-alt"></i>
          </button>
        </form>
      </a>
      {% endfor %}

      <!-- Add service card -->
      <a href="{{ url_for('add_service') }}" class="service-card add-card">
        <div class="service-icon">
          <i class="fas fa-plus-circle"></i>
        </div>
        <h3>Add New Service</h3>
        <p>Create a custom service link</p>
      </a>
    </div>
  </section>

  <!-- System Management Section -->
  <section class="dashboard-section" data-aos="fade-up" data-aos-delay="100">
    <h2 class="section-title">
      <i class="fas fa-server"></i>
      System Management
    </h2>
    <div class="service-grid">
      <a href="https://unifi.ui.com" target="_blank" class="service-card">
        <div class="service-icon">
          <i class="fas fa-wifi"></i>
        </div>
        <h3>Unifi Controller</h3>
        <p>Network Management</p>
      </a>
      
      <a href="https://vscode.drewwilliams.biz/" target="_blank" class="service-card">
        <div class="service-icon">
          <i class="fas fa-code"></i>
        </div>
        <h3>Code Server</h3>
        <p>Development Environment</p>
      </a>

      <a href="https://portainer.drewwilliams.biz/" target="_blank" class="service-card">
        <div class="service-icon">
          <i class="fas fa-boxes"></i>
        </div>
        <h3>Portainer</h3>
        <p>Container Management</p>
      </a>

      <a href="https://glances.drewwilliams.biz/" target="_blank" class="service-card">
        <div class="service-icon">
          <i class="fas fa-tachometer-alt"></i>
        </div>
        <h3>Glances</h3>
        <p>System Monitoring</p>
      </a>

      <a href="https://webmin.drewwilliams.biz/" target="_blank" class="service-card">
        <div class="service-icon">
          <i class="fas fa-cogs"></i>
        </div>
        <h3>Webmin</h3>
        <p>System Configuration</p>
      </a>
    </div>
  </section>

  <!-- Weather Section -->
  {% if forecast_data %}
  <section class="dashboard-section" data-aos="fade-up">
    <h2 class="section-title">
      <i class="fas fa-cloud-sun"></i>
      Weather Forecast for {{ city_name }}
    </h2>
    <div class="weather-grid">
      {% for day in forecast_data %}
      <div class="weather-card">
        <h3>{{ day.date_str }}</h3>
        <img src="{{ day.icon_url }}" alt="{{ day.description }}">
        <p class="temp-range">{{ day.temp_min }}°F - {{ day.temp_max }}°F</p>
        <p class="weather-desc">{{ day.description }}</p>
      </div>
      {% endfor %}
    </div>
  </section>
  {% endif %}
</div>

<style>
.dashboard-header {
  margin-bottom: var(--spacing-xl);
}

.welcome-text {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: var(--spacing-xs);
}

.dashboard-section {
  margin-bottom: var(--spacing-xl);
}

.section-title {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  font-size: 1.5rem;
  margin-bottom: var(--spacing-lg);
}

.service-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: var(--spacing-md);
}

.service-card {
  background-color: white;
  padding: var(--spacing-lg);
  border-radius: var(--radius-lg);
  text-decoration: none;
  color: var(--text-light);
  transition: all var(--transition-normal);
  border: 1px solid #e5e7eb;
}

.service-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-lg);
  border-color: var(--primary);
}

.service-icon {
  font-size: 2rem;
  color: var(--primary);
  margin-bottom: var(--spacing-md);
}

.service-card h3 {
  font-size: 1.25rem;
  margin-bottom: var(--spacing-xs);
  color: var(--text-dark);
}

.service-card p {
  font-size: 0.875rem;
  opacity: 0.8;
}

.weather-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--spacing-md);
}

.weather-card {
  background-color: white;
  padding: var(--spacing-lg);
  border-radius: var(--radius-lg);
  text-align: center;
  text-decoration: none;
  color: var(--text-dark);
  transition: all var(--transition-normal);
  border: 1px solid #e5e7eb;
}

.weather-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-lg);
  border-color: var(--primary);
}

.weather-date {
  font-weight: 600;
  margin-bottom: var(--spacing-sm);
}

.weather-icon img {
  width: 64px;
  height: 64px;
  margin: var(--spacing-sm) 0;
}

.weather-temp {
  font-size: 1.5rem;
  font-weight: 700;
  margin: var(--spacing-sm) 0;
}

.weather-desc {
  font-size: 0.9rem;
  opacity: 0.8;
}

/* Dark mode styles */
body.dark-mode .service-card,
body.dark-mode .weather-card {
  background-color: #1f2937;
  border-color: #374151;
}

body.dark-mode .service-card h3,
body.dark-mode .weather-card {
  color: var(--text-dark);
}

body.dark-mode .service-card:hover,
body.dark-mode .weather-card:hover {
  border-color: var(--primary);
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .service-grid,
  .weather-grid {
    grid-template-columns: 1fr;
  }
  
  .welcome-text {
    font-size: 1.5rem;
  }
}

.delete-service {
  position: absolute;
  top: var(--spacing-sm);
  right: var(--spacing-sm);
  margin: 0;
}

.btn-delete-service {
  background: none;
  border: none;
  color: var(--danger);
  cursor: pointer;
  padding: var(--spacing-xs);
  opacity: 0;
  transition: opacity var(--transition-fast);
}

.service-card:hover .btn-delete-service {
  opacity: 1;
}

.add-card {
  border: 2px dashed #e5e7eb;
  background-color: transparent;
}

.add-card:hover {
  border-color: var(--primary);
  background-color: rgba(79, 70, 229, 0.05);
}
</style>
{% endblock %}